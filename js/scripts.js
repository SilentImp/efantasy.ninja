"use strict";function _classCallCheck(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function n(n,e){for(var t=0;t<e.length;t++){var a=e[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(n,a.key,a)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();!function(){var n=function(){function n(){_classCallCheck(this,n);var e=new Promise(function(n,e){return"loading"!=document.readyState?n():void document.addEventListener("DOMContentLoaded",function(){return n()})});e.then(this.init.bind(this))}return _createClass(n,[{key:"init",value:function(){this.dirthday=new Pikaday({field:document.querySelector(".account__input_date"),format:"YYYY-MM-DD"})}}]),n}();new n}();
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();!function(){var e=function(){function e(){_classCallCheck(this,e);var t=new Promise(function(e,t){return"loading"!=document.readyState?e():void document.addEventListener("DOMContentLoaded",function(){return e()})});t.then(this.init.bind(this))}return _createClass(e,[{key:"init",value:function(){var e=this;if(this.widget=document.querySelector(".edit"),null!=this.widget){var t=this.widget.querySelectorAll(".button_add"),a=this.widget.querySelectorAll(".button_remove");this.players=this.widget.querySelector(".edit__available-players"),this.team=this.widget.querySelector(".edit__players"),this.form=this.widget.querySelector("form.edit__teamer"),this.popup=this.widget.querySelector(".edit__popup"),this.popup_close=this.popup.querySelector(".edit__popup-close"),[].forEach.call(t,function(t){t.addEventListener("click",e.addPlayer.bind(e))}),[].forEach.call(a,function(t){t.addEventListener("click",e.removePlayer.bind(e))}),this.popup_close.addEventListener("click",this.closePopup.bind(this)),this.form.addEventListener("submit",this.checkTeam.bind(this))}}},{key:"closePopup",value:function(e){this.popup.style.display="none"}},{key:"checkTeam",value:function(e){var t=e.currentTarget.querySelectorAll(".teamer");return t.length<8?(this.popup.style.display="block",void e.preventDefault()):void 0}},{key:"removePlayer",value:function(e){var t=e.currentTarget.closest(".teamer"),a=parseInt(t.getAttribute("data-id"),10),r=document.createElement("li");r.classList.add("edit__player"),t.parentNode.parentNode.removeChild(t.parentNode),this.players.querySelector('[data-id="'+a+'"]').classList.remove("edit__available_added"),this.team.appendChild(r)}},{key:"addPlayer",value:function(e){var t=e.currentTarget.closest("tr");if(!t.classList.contains("edit__available_added")){var a=this.team.querySelectorAll(".teamer"),r=void 0;if(0==a.length)r=this.team.querySelector(".edit__player");else if(r=a[a.length-1].parentNode.nextElementSibling,null==r)return;var i=t.querySelector(".edit__available-name").textContent,n=t.querySelector(".edit__available-players-salary").textContent,l=t.querySelector(".edit__available-avatar").getAttribute("src"),d=t.getAttribute("data-id"),s=this.createPlayer(d,l,i,n);r.appendChild(s),t.classList.add("edit__available_added")}}},{key:"createPlayer",value:function(e,t,a,r){var i=document.createElement("DIV"),n=document.createElement("P"),l=document.createElement("P"),d=document.createElement("BUTTON"),s=document.createElement("INPUT"),c=document.createElement("IMG");return i.setAttribute("data-id",e),i.classList.add("teamer"),n.classList.add("teamer__name"),n.appendChild(document.createTextNode(a)),l.classList.add("teamer__salary"),l.appendChild(document.createTextNode(r)),c.classList.add("teamer__avatar"),c.setAttribute("alt","Avatar"),c.setAttribute("src",t),s.setAttribute("type","hidden"),s.setAttribute("name","team[]"),s.setAttribute("value",e),d.classList.add("button"),d.classList.add("button_remove"),d.classList.add("teamer__remove"),d.setAttribute("type","button"),d.appendChild(document.createTextNode("-")),d.addEventListener("click",this.removePlayer.bind(this)),i.appendChild(c),i.appendChild(n),i.appendChild(l),i.appendChild(d),i.appendChild(s),i}}]),e}();new e}();
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t,e){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){var t=this;if(this.filter=document.querySelector(".filter"),null!=this.filter){this.container=document.querySelector("[data-container="+this.filter.getAttribute("data-target")+"]");var e=this.filter.querySelectorAll("input[data-filter]");[].forEach.call(e,function(e){e.addEventListener("change",t.filterFields.bind(t))})}}},{key:"filterFields",value:function(t){var e=t.currentTarget,n=e.getAttribute("data-filter");"all"==n?[].forEach.call(this.container.querySelectorAll("[data-tag]"),function(t){t.classList.toggle("hidden",!1)}):[].forEach.call(this.container.querySelectorAll("[data-tag]"),function(t){t.getAttribute("data-tag").toLowerCase()==n.toLowerCase()?t.classList.toggle("hidden",!1):t.classList.toggle("hidden",!0)})}}]),t}();new t}();
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();!function(){var e=function(){function e(){_classCallCheck(this,e);var t=new Promise(function(e,t){return"loading"!=document.readyState?e():void document.addEventListener("DOMContentLoaded",function(){return e()})});t.then(this.init.bind(this))}return _createClass(e,[{key:"init",value:function(){if(this.menu=document.querySelector(".navigation"),null!=this.menu){this.open=!1,this.wrapper=this.menu.querySelector(".navigation__wrapper");var e=this.menu.querySelector(".navigation__toggle");e.addEventListener("click",this.toggleMenu.bind(this)),window.addEventListener("resize",this.resized.bind(this))}}},{key:"resized",value:function(){Modernizr.mq("(min-width: 1000px)")&&this.open&&(this.open=!1,this.wrapper.removeAttribute("style"),this.menu.classList.toggle("navigation_open",!1))}},{key:"toggleMenu",value:function(){this.open=!this.open,Velocity(this.wrapper,"stop"),this.menu.classList.toggle("navigation_open"),this.open?Velocity(this.wrapper,{translateY:this.wrapper.offsetHeight+this.menu.offsetHeight},{duration:250}):Velocity(this.wrapper,{translateY:0},{duration:250})}}]),e}();new e}();
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}();!function(){var t=function(){function t(){_classCallCheck(this,t);var e=new Promise(function(t,e){return"loading"!=document.readyState?t():void document.addEventListener("DOMContentLoaded",function(){return t()})});e.then(this.init.bind(this))}return _createClass(t,[{key:"init",value:function(){var t=this;if(this.popup=document.querySelector(".popup"),null!=this.popup){this.lightbox=document.querySelector(".popup__lightbox");var e=document.querySelector(".popup__close"),o=document.querySelectorAll(".popup__button"),n=document.querySelectorAll('[data-action="open popup"]');this.current_button=document.querySelector(".popup__button_current"),this.current_tab=document.querySelector(".popup__tab_current"),e.addEventListener("click",this.closePopup.bind(this)),this.lightbox.addEventListener("click",this.closePopup.bind(this)),[].forEach.call(o,function(e){e.addEventListener("click",t.openTab.bind(t))}),[].forEach.call(n,function(e){e.addEventListener("click",t.openPopup.bind(t))})}}},{key:"openTab",value:function(t){var e=t.currentTarget,o=e.getAttribute("data-target"),n=document.querySelector('[data-tab="'+o+'"]');this.current_button.classList.remove("popup__button_current"),this.current_tab.classList.remove("popup__tab_current"),e.classList.add("popup__button_current"),n.classList.add("popup__tab_current"),this.current_button=e,this.current_tab=n}},{key:"closePopup",value:function(){document.body.classList.toggle("popup-opened",!1),Velocity(this.lightbox,"stop"),Velocity(this.lightbox,"fadeOut",{duration:250}),Velocity(this.popup,"stop"),Velocity(this.popup,"fadeOut",{duration:250})}},{key:"openPopup",value:function(){document.body.classList.toggle("popup-opened",!0),Velocity(this.lightbox,"stop"),Velocity(this.lightbox,"fadeIn",{duration:250}),Velocity(this.popup,"stop"),Velocity(this.popup,"fadeIn",{duration:250})}}]),t}();window.popup=new t}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY291bnQvYWNjb3VudC5qcyIsImVkaXQvZWRpdC5qcyIsImZpbHRlci9maWx0ZXIuanMiLCJuYXZpZ2F0aW9uL25hdmlnYXRpb24uanMiLCJwb3B1cC9wb3B1cC5qcyJdLCJuYW1lcyI6WyJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIkFjY291bnQiLCJ0aGlzIiwicmVhZHkiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImRvY3VtZW50IiwicmVhZHlTdGF0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0aGVuIiwiaW5pdCIsImJpbmQiLCJ2YWx1ZSIsImRpcnRoZGF5IiwiUGlrYWRheSIsImZpZWxkIiwicXVlcnlTZWxlY3RvciIsImZvcm1hdCIsIkVkaXQiLCJfdGhpcyIsIndpZGdldCIsImFkZF9idXR0b25zIiwicXVlcnlTZWxlY3RvckFsbCIsInJlbW92ZV9idXR0b25zIiwicGxheWVycyIsInRlYW0iLCJmb3JtIiwicG9wdXAiLCJwb3B1cF9jbG9zZSIsImZvckVhY2giLCJjYWxsIiwiYnV0dG9uIiwiYWRkUGxheWVyIiwicmVtb3ZlUGxheWVyIiwiY2xvc2VQb3B1cCIsImNoZWNrVGVhbSIsImV2ZW50Iiwic3R5bGUiLCJkaXNwbGF5IiwiY3VycmVudFRhcmdldCIsInByZXZlbnREZWZhdWx0IiwicGxheWVyIiwiY2xvc2VzdCIsImlkIiwicGFyc2VJbnQiLCJnZXRBdHRyaWJ1dGUiLCJsaSIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJyZW1vdmUiLCJhcHBlbmRDaGlsZCIsImNvbnRhaW5zIiwidGVhbWVycyIsImNvbnRhaW5lciIsInVuZGVmaW5lZCIsIm5leHRFbGVtZW50U2libGluZyIsIm5hbWUiLCJ0ZXh0Q29udGVudCIsInNhbGFyeSIsInNyYyIsIm1lbWJlciIsImNyZWF0ZVBsYXllciIsInBfbmFtZSIsInBfc2FsYXJ5IiwiaW5wdXQiLCJpbWciLCJzZXRBdHRyaWJ1dGUiLCJjcmVhdGVUZXh0Tm9kZSIsIkZpbHRlciIsImZpbHRlciIsImlucHV0cyIsImZpbHRlckZpZWxkcyIsInRhZyIsInRyIiwidG9nZ2xlIiwidG9Mb3dlckNhc2UiLCJOYXZpZ2F0aW9uIiwibWVudSIsIm9wZW4iLCJ3cmFwcGVyIiwidG9nZ2xlTWVudSIsIndpbmRvdyIsInJlc2l6ZWQiLCJNb2Rlcm5penIiLCJtcSIsInJlbW92ZUF0dHJpYnV0ZSIsIlZlbG9jaXR5IiwidHJhbnNsYXRlWSIsIm9mZnNldEhlaWdodCIsImR1cmF0aW9uIiwiUG9wdXAiLCJsaWdodGJveCIsImNsb3NlIiwibGlua3MiLCJvcGVuX2xpbmtzIiwiY3VycmVudF9idXR0b24iLCJjdXJyZW50X3RhYiIsImxpbmsiLCJvcGVuVGFiIiwib3BlblBvcHVwIiwidGFiIiwiYm9keSJdLCJtYXBwaW5ncyI6IkFBQUEsWUFJQSxTQUFTQSxpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0FGaEgsR0FBSUMsY0FBZSxXQUFlLFFBQVNDLEdBQWlCQyxFQUFRQyxHQUFTLElBQUssR0FBSUMsR0FBSSxFQUFHQSxFQUFJRCxFQUFNRSxPQUFRRCxJQUFLLENBQUUsR0FBSUUsR0FBYUgsRUFBTUMsRUFBSUUsR0FBV0MsV0FBYUQsRUFBV0MsYUFBYyxFQUFPRCxFQUFXRSxjQUFlLEVBQVUsU0FBV0YsS0FBWUEsRUFBV0csVUFBVyxHQUFNQyxPQUFPQyxlQUFlVCxFQUFRSSxFQUFXTSxJQUFL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IHN0cmljdFwiO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgY2xhc3MgQWNjb3VudCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gU3RhcnQgaW5pdGlhbGl6YXRpb24gb24gZG9tbG9hZFxuICAgICAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgICAgICovXG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgbGV0IHJlYWR5ID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9IFwibG9hZGluZ1wiKSByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHJlc29sdmUoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlYWR5LnRoZW4odGhpcy5pbml0LmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBBZGRpbmcgZXZlbnRzIGFuZCBwcm9wZXJ0aWVzXG4gICAgICAgICAqL1xuICAgICAgICBpbml0KCkge1xuICAgICAgICAgICAgdGhpcy5kaXJ0aGRheSA9IG5ldyBQaWthZGF5KHtcbiAgICAgICAgICAgICAgICBmaWVsZDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFjY291bnRfX2lucHV0X2RhdGUnKVxuICAgICAgICAgICAgICAgICwgZm9ybWF0OiAnWVlZWS1NTS1ERCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIG5ldyBBY2NvdW50O1xufSkoKTtcbiIsIlwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgY2xhc3MgRWRpdCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gU3RhcnQgaW5pdGlhbGl6YXRpb24gb24gZG9tbG9hZFxuICAgICAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgICAgICovXG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgbGV0IHJlYWR5ID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9IFwibG9hZGluZ1wiKSByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHJlc29sdmUoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlYWR5LnRoZW4odGhpcy5pbml0LmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBBZGRpbmcgZXZlbnRzIGFuZCBwcm9wZXJ0aWVzXG4gICAgICAgICAqL1xuICAgICAgICBpbml0KCkge1xuICAgICAgICAgICAgdGhpcy53aWRnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZWRpdCcpO1xuICAgICAgICAgICAgaWYgKHRoaXMud2lkZ2V0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgYWRkX2J1dHRvbnMgPSB0aGlzLndpZGdldC5xdWVyeVNlbGVjdG9yQWxsKCcuYnV0dG9uX2FkZCcpXG4gICAgICAgICAgICAgICAgLCByZW1vdmVfYnV0dG9ucyA9IHRoaXMud2lkZ2V0LnF1ZXJ5U2VsZWN0b3JBbGwoJy5idXR0b25fcmVtb3ZlJyk7XG4gICAgICAgICAgICB0aGlzLnBsYXllcnMgPSB0aGlzLndpZGdldC5xdWVyeVNlbGVjdG9yKCcuZWRpdF9fYXZhaWxhYmxlLXBsYXllcnMnKTtcbiAgICAgICAgICAgIHRoaXMudGVhbSA9IHRoaXMud2lkZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5lZGl0X19wbGF5ZXJzJyk7XG4gICAgICAgICAgICB0aGlzLmZvcm0gPSB0aGlzLndpZGdldC5xdWVyeVNlbGVjdG9yKCdmb3JtLmVkaXRfX3RlYW1lcicpO1xuICAgICAgICAgICAgdGhpcy5wb3B1cCA9IHRoaXMud2lkZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5lZGl0X19wb3B1cCcpO1xuICAgICAgICAgICAgdGhpcy5wb3B1cF9jbG9zZSA9IHRoaXMucG9wdXAucXVlcnlTZWxlY3RvcignLmVkaXRfX3BvcHVwLWNsb3NlJyk7XG4gICAgICAgICAgICBbXS5mb3JFYWNoLmNhbGwoYWRkX2J1dHRvbnMsIChidXR0b24pID0+IHtcbiAgICAgICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmFkZFBsYXllci5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgW10uZm9yRWFjaC5jYWxsKHJlbW92ZV9idXR0b25zLCAoYnV0dG9uKSA9PiB7XG4gICAgICAgICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5yZW1vdmVQbGF5ZXIuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMucG9wdXBfY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsb3NlUG9wdXAuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB0aGlzLmZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5jaGVja1RlYW0uYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICBjbG9zZVBvcHVwIChldmVudCkge1xuICAgICAgICAgICAgdGhpcy5wb3B1cC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIH1cblxuICAgICAgICBjaGVja1RlYW0gKGV2ZW50KSB7XG5cbiAgICAgICAgICAgIGxldCBwbGF5ZXJzID0gZXZlbnQuY3VycmVudFRhcmdldC5xdWVyeVNlbGVjdG9yQWxsKCcudGVhbWVyJyk7XG4gICAgICAgICAgICBpZiAocGxheWVycy5sZW5ndGggPCA4KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3B1cC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmVtb3ZlUGxheWVyIChldmVudCkge1xuICAgICAgICAgICAgbGV0IHBsYXllciA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuY2xvc2VzdCgnLnRlYW1lcicpXG4gICAgICAgICAgICAgICAgLCBpZCA9IHBhcnNlSW50KHBsYXllci5nZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnKSwgMTApXG4gICAgICAgICAgICAgICAgLCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgICAgICBsaS5jbGFzc0xpc3QuYWRkKCdlZGl0X19wbGF5ZXInKTtcbiAgICAgICAgICAgIHBsYXllci5wYXJlbnROb2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocGxheWVyLnBhcmVudE5vZGUpO1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXJzLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWlkPVwiJyArIGlkICsgJ1wiXScpLmNsYXNzTGlzdC5yZW1vdmUoJ2VkaXRfX2F2YWlsYWJsZV9hZGRlZCcpO1xuICAgICAgICAgICAgdGhpcy50ZWFtLmFwcGVuZENoaWxkKGxpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGFkZFBsYXllciAoZXZlbnQpIHtcbiAgICAgICAgICAgIGxldCBwbGF5ZXIgPSBldmVudC5jdXJyZW50VGFyZ2V0LmNsb3Nlc3QoJ3RyJyk7XG4gICAgICAgICAgICBpZiAocGxheWVyLmNsYXNzTGlzdC5jb250YWlucygnZWRpdF9fYXZhaWxhYmxlX2FkZGVkJykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgdGVhbWVycyA9IHRoaXMudGVhbS5xdWVyeVNlbGVjdG9yQWxsKCcudGVhbWVyJylcbiAgICAgICAgICAgICAgICAsIGNvbnRhaW5lcjtcbiAgICAgICAgICAgIGlmICh0ZWFtZXJzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyID0gdGhpcy50ZWFtLnF1ZXJ5U2VsZWN0b3IoJy5lZGl0X19wbGF5ZXInKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyID0gdGVhbWVyc1t0ZWFtZXJzLmxlbmd0aC0xXS5wYXJlbnROb2RlLm5leHRFbGVtZW50U2libGluZztcbiAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBuYW1lID0gcGxheWVyLnF1ZXJ5U2VsZWN0b3IoJy5lZGl0X19hdmFpbGFibGUtbmFtZScpLnRleHRDb250ZW50XG4gICAgICAgICAgICAgICAgLCBzYWxhcnkgPSBwbGF5ZXIucXVlcnlTZWxlY3RvcignLmVkaXRfX2F2YWlsYWJsZS1wbGF5ZXJzLXNhbGFyeScpLnRleHRDb250ZW50XG4gICAgICAgICAgICAgICAgLCBzcmMgPSBwbGF5ZXIucXVlcnlTZWxlY3RvcignLmVkaXRfX2F2YWlsYWJsZS1hdmF0YXInKS5nZXRBdHRyaWJ1dGUoJ3NyYycpXG4gICAgICAgICAgICAgICAgLCBpZCA9IHBsYXllci5nZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnKVxuICAgICAgICAgICAgICAgICwgbWVtYmVyID0gdGhpcy5jcmVhdGVQbGF5ZXIoaWQsIHNyYywgbmFtZSwgc2FsYXJ5KTtcblxuICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKG1lbWJlcik7XG4gICAgICAgICAgICBwbGF5ZXIuY2xhc3NMaXN0LmFkZCgnZWRpdF9fYXZhaWxhYmxlX2FkZGVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjcmVhdGVQbGF5ZXIgKGlkLCBzcmMsIG5hbWUsIHNhbGFyeSkge1xuICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpXG4gICAgICAgICAgICAgICAgLCBwX25hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdQJylcbiAgICAgICAgICAgICAgICAsIHBfc2FsYXJ5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnUCcpXG4gICAgICAgICAgICAgICAgLCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdCVVRUT04nKVxuICAgICAgICAgICAgICAgICwgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdJTlBVVCcpXG4gICAgICAgICAgICAgICAgLCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdJTUcnKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnLCBpZCk7XG4gICAgICAgICAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgndGVhbWVyJyk7XG4gICAgICAgICAgICBwX25hbWUuY2xhc3NMaXN0LmFkZCgndGVhbWVyX19uYW1lJyk7XG4gICAgICAgICAgICBwX25hbWUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUobmFtZSkpO1xuICAgICAgICAgICAgcF9zYWxhcnkuY2xhc3NMaXN0LmFkZCgndGVhbWVyX19zYWxhcnknKTtcbiAgICAgICAgICAgIHBfc2FsYXJ5LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHNhbGFyeSkpO1xuICAgICAgICAgICAgaW1nLmNsYXNzTGlzdC5hZGQoJ3RlYW1lcl9fYXZhdGFyJyk7XG4gICAgICAgICAgICBpbWcuc2V0QXR0cmlidXRlKCdhbHQnLCAnQXZhdGFyJylcbiAgICAgICAgICAgIGltZy5zZXRBdHRyaWJ1dGUoJ3NyYycsIHNyYylcbiAgICAgICAgICAgIGlucHV0LnNldEF0dHJpYnV0ZSgndHlwZScsICdoaWRkZW4nKTtcbiAgICAgICAgICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnbmFtZScsICd0ZWFtW10nKTtcbiAgICAgICAgICAgIGlucHV0LnNldEF0dHJpYnV0ZSgndmFsdWUnLCBpZCk7XG4gICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LmFkZCgnYnV0dG9uJyk7XG4gICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LmFkZCgnYnV0dG9uX3JlbW92ZScpO1xuICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3RlYW1lcl9fcmVtb3ZlJyk7XG4gICAgICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywnYnV0dG9uJyk7XG4gICAgICAgICAgICBidXR0b24uYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJy0nKSk7XG4gICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnJlbW92ZVBsYXllci5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChpbWcpO1xuICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHBfbmFtZSk7XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocF9zYWxhcnkpO1xuICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGJ1dHRvbik7XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoaW5wdXQpO1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRhaW5lcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBuZXcgRWRpdDtcbn0pKCk7XG4iLCJcInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uKCkge1xuICAgIGNsYXNzIEZpbHRlciB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gU3RhcnQgaW5pdGlhbGl6YXRpb24gb24gZG9tbG9hZFxuICAgICAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgICAgICovXG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgbGV0IHJlYWR5ID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9IFwibG9hZGluZ1wiKSByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHJlc29sdmUoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlYWR5LnRoZW4odGhpcy5pbml0LmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBBZGRpbmcgZXZlbnRzIGFuZCBwcm9wZXJ0aWVzXG4gICAgICAgICAqL1xuICAgICAgICBpbml0KCkge1xuICAgICAgICAgICAgdGhpcy5maWx0ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmlsdGVyJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5maWx0ZXIgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIltkYXRhLWNvbnRhaW5lcj1cIiArIHRoaXMuZmlsdGVyLmdldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQnKSArIFwiXVwiKTtcbiAgICAgICAgICAgIGxldCBpbnB1dHMgPSB0aGlzLmZpbHRlci5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFtkYXRhLWZpbHRlcl0nKTtcbiAgICAgICAgICAgIFtdLmZvckVhY2guY2FsbChpbnB1dHMsIChpbnB1dCkgPT4ge1xuICAgICAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRoaXMuZmlsdGVyRmllbGRzLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmaWx0ZXJGaWVsZHMgKGV2ZW50KSB7XG4gICAgICAgICAgICBsZXQgaW5wdXQgPSBldmVudC5jdXJyZW50VGFyZ2V0XG4gICAgICAgICAgICAgICAgLCB0YWcgPSBpbnB1dC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZmlsdGVyJyk7XG5cbiAgICAgICAgICAgIGlmICh0YWcgPT0gJ2FsbCcpIHtcbiAgICAgICAgICAgICAgICBbXS5mb3JFYWNoLmNhbGwodGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtdGFnXScpLCAodHIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdHIuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBbXS5mb3JFYWNoLmNhbGwodGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtdGFnXScpLCAodHIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYodHIuZ2V0QXR0cmlidXRlKCdkYXRhLXRhZycpLnRvTG93ZXJDYXNlKCkgPT0gdGFnLnRvTG93ZXJDYXNlKCkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHIuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJywgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHIuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBuZXcgRmlsdGVyO1xufSkoKTtcbiIsIlwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24oKSB7XG5cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24gTmF2aWdhdGlvbiBjbGFzc1xuICAgICAqIEBjbGFzc1xuICAgICAqL1xuICAgIGNsYXNzIE5hdmlnYXRpb24ge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gU3RhcnQgaW5pdGlhbGl6YXRpb24gb24gZG9tbG9hZFxuICAgICAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgICAgICovXG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgbGV0IHJlYWR5ID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9IFwibG9hZGluZ1wiKSByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHJlc29sdmUoKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlYWR5LnRoZW4odGhpcy5pbml0LmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBBZGRpbmcgZXZlbnRzIGFuZCBwcm9wZXJ0aWVzXG4gICAgICAgICAqL1xuICAgICAgICBpbml0KCkge1xuICAgICAgICAgICAgdGhpcy5tZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5hdmlnYXRpb24nKTtcbiAgICAgICAgICAgIGlmICh0aGlzLm1lbnUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMub3BlbiA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy53cmFwcGVyID0gdGhpcy5tZW51LnF1ZXJ5U2VsZWN0b3IoJy5uYXZpZ2F0aW9uX193cmFwcGVyJyk7XG4gICAgICAgICAgICBsZXQgdG9nZ2xlID0gdGhpcy5tZW51LnF1ZXJ5U2VsZWN0b3IoJy5uYXZpZ2F0aW9uX190b2dnbGUnKTtcbiAgICAgICAgICAgIHRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMudG9nZ2xlTWVudS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnJlc2l6ZWQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIFJlc2l6ZSB3aW5kb3dcbiAgICAgICAgICovXG4gICAgICAgIHJlc2l6ZWQoKSB7XG4gICAgICAgICAgICBpZiAoIE1vZGVybml6ci5tcSgnKG1pbi13aWR0aDogMTAwMHB4KScpICYmIHRoaXMub3BlbiApIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIucmVtb3ZlQXR0cmlidXRlKCdzdHlsZScpO1xuICAgICAgICAgICAgICAgIHRoaXMubWVudS5jbGFzc0xpc3QudG9nZ2xlKFwibmF2aWdhdGlvbl9vcGVuXCIsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAZGVzY3JpcHRpb24gT3BlbiB0YWJcbiAgICAgICAgICogQHBhcmFtIGV2ZW50IEV2ZW50IHtFdmVudH0gdG8gZ2V0IGJ1dHRvbiB1c2VyIGhhdmUgY2xpY2tlZFxuICAgICAgICAgKi9cbiAgICAgICAgdG9nZ2xlTWVudSgpIHtcbiAgICAgICAgICAgIHRoaXMub3BlbiA9ICF0aGlzLm9wZW47XG4gICAgICAgICAgICBWZWxvY2l0eSh0aGlzLndyYXBwZXIsIFwic3RvcFwiKTtcbiAgICAgICAgICAgIHRoaXMubWVudS5jbGFzc0xpc3QudG9nZ2xlKFwibmF2aWdhdGlvbl9vcGVuXCIpO1xuICAgICAgICAgICAgaWYgKHRoaXMub3Blbikge1xuICAgICAgICAgICAgICAgIFZlbG9jaXR5KHRoaXMud3JhcHBlciwge1xuICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGVZOiB0aGlzLndyYXBwZXIub2Zmc2V0SGVpZ2h0ICsgdGhpcy5tZW51Lm9mZnNldEhlaWdodFxuICAgICAgICAgICAgICAgIH0sIHtkdXJhdGlvbjogMjUwfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFZlbG9jaXR5KHRoaXMud3JhcHBlciwge1xuICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGVZOiAwXG4gICAgICAgICAgICAgICAgfSwge2R1cmF0aW9uOiAyNTB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIG5ldyBOYXZpZ2F0aW9uO1xufSkoKTtcbiIsIlwidXNlIHN0cmljdFwiO1xuXG4oZnVuY3Rpb24oKSB7XG5cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24gUG9wdXAgY2xhc3NcbiAgICAgKiBAY2xhc3NcbiAgICAgKi9cbiAgICBjbGFzcyBQb3B1cCB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBTdGFydCBpbml0aWFsaXphdGlvbiBvbiBkb21sb2FkXG4gICAgICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAgICAgKi9cbiAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICBsZXQgcmVhZHkgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgIT0gXCJsb2FkaW5nXCIpIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4gcmVzb2x2ZSgpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVhZHkudGhlbih0aGlzLmluaXQuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIEFkZGluZyBldmVudHMgYW5kIHByb3BlcnRpZXNcbiAgICAgICAgICovXG4gICAgICAgIGluaXQoKSB7XG4gICAgICAgICAgICB0aGlzLnBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5wb3B1cCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmxpZ2h0Ym94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19saWdodGJveCcpO1xuXG4gICAgICAgICAgICBsZXQgY2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Nsb3NlJylcbiAgICAgICAgICAgICAgICAsIGxpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19idXR0b24nKVxuICAgICAgICAgICAgICAgICwgb3Blbl9saW5rcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWFjdGlvbj1cIm9wZW4gcG9wdXBcIl0nKVxuXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b25fY3VycmVudCcpO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50X3RhYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fdGFiX2N1cnJlbnQnKTtcblxuICAgICAgICAgICAgY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsb3NlUG9wdXAuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB0aGlzLmxpZ2h0Ym94LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbG9zZVBvcHVwLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgW10uZm9yRWFjaC5jYWxsKGxpbmtzLCAobGluaykgPT4ge1xuICAgICAgICAgICAgICAgIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9wZW5UYWIuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFtdLmZvckVhY2guY2FsbChvcGVuX2xpbmtzLCAobGluaykgPT4ge1xuICAgICAgICAgICAgICAgIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9wZW5Qb3B1cC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBPcGVuIHRhYlxuICAgICAgICAgKiBAcGFyYW0gZXZlbnQgRXZlbnQge0V2ZW50fSB0byBnZXQgYnV0dG9uIHVzZXIgaGF2ZSBjbGlja2VkXG4gICAgICAgICAqL1xuICAgICAgICBvcGVuVGFiKGV2ZW50KSB7XG4gICAgICAgICAgICBsZXQgYnV0dG9uID0gZXZlbnQuY3VycmVudFRhcmdldFxuICAgICAgICAgICAgICAgICwgdGFyZ2V0ID0gYnV0dG9uLmdldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQnKVxuICAgICAgICAgICAgICAgICwgdGFiID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtdGFiPVwiJyArIHRhcmdldCArICdcIl0nKTtcblxuICAgICAgICAgICAgdGhpcy5jdXJyZW50X2J1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF9fYnV0dG9uX2N1cnJlbnQnKTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF90YWIuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfX3RhYl9jdXJyZW50Jyk7XG4gICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LmFkZCgncG9wdXBfX2J1dHRvbl9jdXJyZW50Jyk7XG4gICAgICAgICAgICB0YWIuY2xhc3NMaXN0LmFkZCgncG9wdXBfX3RhYl9jdXJyZW50Jyk7XG5cbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9idXR0b24gPSBidXR0b247XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfdGFiID0gdGFiO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBkZXNjcmlwdGlvbiBDbG9zZSBwb3B1cCBhbmQgbGlnaHRib3hcbiAgICAgICAgICovXG4gICAgICAgIGNsb3NlUG9wdXAoKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC50b2dnbGUoJ3BvcHVwLW9wZW5lZCcsIGZhbHNlKTtcbiAgICAgICAgICAgIFZlbG9jaXR5KHRoaXMubGlnaHRib3gsIFwic3RvcFwiKTtcbiAgICAgICAgICAgIFZlbG9jaXR5KHRoaXMubGlnaHRib3gsIFwiZmFkZU91dFwiLCB7ZHVyYXRpb246IDI1MH0pO1xuICAgICAgICAgICAgVmVsb2NpdHkodGhpcy5wb3B1cCwgXCJzdG9wXCIpO1xuICAgICAgICAgICAgVmVsb2NpdHkodGhpcy5wb3B1cCwgXCJmYWRlT3V0XCIsIHtkdXJhdGlvbjogMjUwfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIENsb3NlIHBvcHVwIGFuZCBsaWdodGJveFxuICAgICAgICAgKi9cbiAgICAgICAgb3BlblBvcHVwKCkge1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QudG9nZ2xlKCdwb3B1cC1vcGVuZWQnLCB0cnVlKTtcbiAgICAgICAgICAgIFZlbG9jaXR5KHRoaXMubGlnaHRib3gsIFwic3RvcFwiKTtcbiAgICAgICAgICAgIFZlbG9jaXR5KHRoaXMubGlnaHRib3gsIFwiZmFkZUluXCIsIHtkdXJhdGlvbjogMjUwfSk7XG4gICAgICAgICAgICBWZWxvY2l0eSh0aGlzLnBvcHVwLCBcInN0b3BcIik7XG4gICAgICAgICAgICBWZWxvY2l0eSh0aGlzLnBvcHVwLCBcImZhZGVJblwiLCB7ZHVyYXRpb246IDI1MH0pO1xuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICB3aW5kb3cucG9wdXAgPSBuZXcgUG9wdXA7XG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9